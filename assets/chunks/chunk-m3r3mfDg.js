import{g as j,d as L}from"./chunk-BN5h9Q8q.js";import{d as b,q as p,n as f,o as r,c as N,k as g,w as C,F as w,h as I,s as D,R as U,S as B,b as V,r as $,U as E,M as O,a as z,j as y,t as R,x as F,y as P}from"./chunk-BIt-4EX2.js";const T=b({__name:"custom-check-tree-list",props:{parent:{type:Object,default:()=>({})},data:{type:Array,default:()=>[]},level:{type:Number,default:1},getChildren:null,model:{type:Object,default:()=>({})}},emits:["setData:model"],setup(e,{emit:n}){const u=e,m=n,i=p(()=>u.parent?.id||"#"),v=p(()=>`check-record-logic-node-${i.value}`);function h(o){m("setData:model",{k:[i.value,"checkedNodes"],v:o})}return(o,t)=>{const l=f("VkCheckRecordLogic"),a=f("VkCheckRecordLogicProvider");return r(),N("div",null,[g(a,{"model-value":V(j)(e.model,[i.value,"checkedNodes"],V(L)),"onUpdate:modelValue":h,"provide-key":v.value},{default:C(()=>[(r(!0),N(w,null,I(e.data,d=>(r(),D(l,{"inject-key":v.value,name:d,key:d.id,custom:!0},{default:C(({isActive:c,toggle:s})=>[g(A,{class:U(["vk-check-record-logic-item",`is-level-${e.level}`]),style:B({"--is-level":e.level}),level:e.level,model:e.model,"is-active":c,toggle:s,node:d,parent:e.parent,"get-children":e.getChildren,"onSetData:model":t[0]||(t[0]=k=>o.$emit("setData:model",k))},null,8,["class","style","level","model","is-active","toggle","node","parent","get-children"])]),_:2},1032,["inject-key","name"]))),128))]),_:1},8,["model-value","provide-key"])])}}}),M=b({components:{ListVue:T},props:["isActive","toggle","node","getChildren","model","level","parent"],emits:{"setData:model":e=>e,nodeLoad:e=>e},setup(e,{emit:n}){const u=p(()=>e.node.id),m=$(!1),i=$(!1),v=async t=>{if(!i.value){const l=await e.getChildren?.(t);l?.length&&(t.children=l,e.isActive&&n("setData:model",{k:[t.id,"checkedNodes"],v:l})),i.value=!0,n("nodeLoad",t)}m.value=!0},h=()=>{e.toggle();const t=!e.isActive;l();function l(a=e.node){const d=a.children?[...a.children]:[];let c=t?d:[];n("setData:model",{k:[a.id,"checkedNodes"],v:c}),d?.forEach(s=>{l(s)})}};o();function o(){n("setData:model",{k:u.value,v:{node:e.node,checkedNodes:[],parent:e.parent},intoUndefined:L})}return E(()=>e.isActive,()=>{const t=e.parent?.id||"#",l=e.model[t].node?.children,a=e.model[t].checkedNodes;if(!l||!a)return;const d=e.model[t].parent?.id||"#",c=e.model[d].checkedNodes;if(!c)return;const s=c.findIndex(k=>k.id===t);if(l.length===a.length)s<0&&n("setData:model",{k:[d,"checkedNodes",c.length],v:e.parent,insert:!0});else if(s>=0){const k=c.filter(S=>S.id!==t);n("setData:model",{k:[d,"checkedNodes"],v:k})}}),{open:m,nodeId:u,handleOpen:v,handleCheck:h}}});function q(e,n,u,m,i,v){const h=f("ElCheckbox"),o=f("ElButton"),t=f("ListVue");return r(),N("div",null,[z("div",null,[g(h,{"model-value":e.isActive,"onUpdate:modelValue":e.handleCheck},null,8,["model-value","onUpdate:modelValue"]),y(" "+R(e.node.id)+" ",1),e.open?(r(),D(o,{key:1,size:"small",onClick:n[1]||(n[1]=l=>e.open=!1)},{default:C(()=>[y(" 收起 ")]),_:1})):(r(),D(o,{key:0,onClick:n[0]||(n[0]=l=>e.handleOpen(e.node)),size:"small"},{default:C(()=>[y(" 展开 ")]),_:1}))]),F(g(t,{level:e.level+1,parent:e.node,data:e.node.children,model:e.model,"onSetData:model":n[2]||(n[2]=l=>e.$emit("setData:model",l)),"get-children":e.getChildren},null,8,["level","parent","data","model","get-children"]),[[P,e.open]])])}const A=O(M,[["render",q]]),H=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{T as _,H as c};
